## 条件判断

```jsx
import { useEffect, useState } from "react"

// count 大于五的时候，打印count的值
export default function App(props) {
  const [ count, setCount ] = useState(0)

  // hook只能在函数组件顶层作用域被调用
  // hook不可以在条件，循环，嵌套函数中调用
  // 目的是确保函数组件被多次调用时，hook的调用顺序是一致的 -- hook中触发的副作用也是一致的，避免出现问题
  if (count > 5) {
    useEffect(() => {
      console.log(count)
    })
  }

  return (
    <>
      <div>{ count }</div>
      <button onClick={() => setCount(count + 1)}>add</button>
    </>
  )
}
```

`解决方法`

```jsx
import { useEffect, useState } from "react"

export default function App(props) {
  const [ count, setCount ] = useState(0)

  useEffect(() => {
    if (count > 5) {
        console.log(count)
    }
  })

  return (
    <>
      <div>{ count }</div>
      <button onClick={() => setCount(count + 1)}>add</button>
    </>
  )
}
```



## 网络请求

```jsx
import { useEffect } from "react"

// 模拟网络请求
function fetchData() {
  return new Promise((resolve) => {
    setTimeout(() => {
      resolve([1, 2, 3, 4, 5])
    }, 1000)
  })
}

export default function App(props) {
  // useEffect如果有返回值，则该返回值必须是一个清理函数
  // async函数的返回值是promise实例，所以下述写法是错误的
  useEffect(async() => {
    const res = await fetchData()
    console.log(res)
  }, [])

  return (
    <></>
  )
}
```

`解决方法一`

```jsx
import { useEffect } from "react"

// 模拟网络请求
function fetchData() {
  return new Promise((resolve) => {
    setTimeout(() => {
      resolve([1, 2, 3, 4, 5])
    }, 1000)
  })
}

export default function App(props) {
  useEffect(() => {
    // 使用promise.then代替
    fetchData().then((data) => {
      console.log(data)
    })
  }, [])

  return (
    <></>
  )
}
```

`解决方法二`

```jsx
import { useEffect } from "react"

// 模拟网络请求
function fetchData() {
  return new Promise((resolve) => {
    setTimeout(() => {
      resolve([1, 2, 3, 4, 5])
    }, 1000)
  })
}

export default function App(props) {
  useEffect(() => {
    // 内部自定义函数，避免useEffect返回promise实例
    async function getData() {
      const res = await fetchData()
      console.log(res)
    }

    getData()
  }, [])

  return (
    <></>
  )
}
```

