Vue2是类，通过new Vue，并传入配置项来完成对应功能，这些配置项叫options api

```js
const vm = new Vue({
  // 配置项
});
```

每个实例都有自己的数据和逻辑处理 「 理论上页面可以存在多个vue实例，实例之间不会冲突 」



## 指定视图

假设挂载点为`#app`， vue渲染后内容会替换`#app`中原本内容

模板使用:  如果定义了 `template`，则优先使用它，否则会使用 `el` 指定的 DOM 结构作为模板

挂载点指定:  有 `el` 配置项, 优先使用`el`配置项，如果没有，则检查是否使用了 `$mount`

>   el配置项和`$mount`的参数 可以是以下两种中的任意一种
>
> 1. css选择器
> 2. DOM元素



还有一种挂载方式是使用`render`函数，并结合JSX

```js
const vm = new Vue({
    el: '#app',
    data: () => ({
      msg: 'Hello World'
    }),
    // render方法需要返回虚拟DOM
    render(h) {
      return (
         // h 是 createElement 的缩写 -- 用于创建虚拟DOM
        h('h2', { class: 'title' }, this.msg)
      )
    }
  })
```



最常用的挂载方式是

1. 模板 编写在 挂载点下
2. 模板通过`$mount`方法进行挂载

以便于在实际挂载前，对vue实例进行一系列额外操作



## data

Vue 会对data中定义的数据进行深度监听和劫持，确保数据的修改能够触发视图的更新

```html
<div id="app">
  <!-- 只要数据被挂载到vue实例上，就可以直接在模板中使用 -->
  <div>name: {{ name }}</div>
  <div>age: {{ age }}</div>
</div>

<script>
  const vm = new Vue({
    // data中定义的数据，会被getter/setter劫持后作为vm的实例属性
    // 所以只有data中定义的数据，才是响应式数据，又被称之为状态
    data: {
      name: 'Klaus',
    }
  });

  // 直接定义的数据，并不是响应式数据
  vm.age = 23;

  vm.$mount('#app');
</script>
```



## template

Vue 中有两个常见的视图构建语法，一个是 `template` 语法，另一个是类似于 React 的 JSX 语法。

`template` 语法中有两个主要的知识点，一个是双大括号（`{{}}`）的“插值”语法，另一个是 Vue 特有的指令（如 `v-for`、`v-if` 等）



小胡子语法「 双大括号语法 」中嵌入的是“JS表达式”

```vue
{{ message }}
```



### 渲染细节

基本数据类型:  

1. `null/undefined` 渲染为空
2.  对于bigInt，执行`String(Number([value]))`
3. 其余情况都可以理解为都转换为了字符串 ：`String([value])`



引用数据类型:

1. 普通对象/数组对象，是基于 JSON.stringify 变为JSON字符串进行渲染
2. 其余的对象，也可以理解为都是基于 String([value]) 变为字符串进行渲染



在mustache中，可以运行一些指定的window下的方法「例如：JSON.parse/stringify、parseInt等」

但并不是全部，具体可以运行那些，取决于vue中定义的[白名单列表](https://github.com/vuejs/vue/blob/v2.6.10/src/core/instance/proxy.js#L9)



## 数据劫持

**数据劫持**：

- Vue 2 使用 `Object.defineProperty` 来实现数据劫持，通过定义 getter 和 setter 来追踪数据的读取和修改。
- 在 getter 中，Vue 会将当前的依赖收集起来，以便在数据变化时进行更新。
- 在 setter 中，当数据被修改时，Vue 会通知所有依赖进行更新，从而实现自动更新界面的效果。



**初始化 data**：

- Vue 通过 `Object.keys` 获取所有可枚举的实例属性（不包括 Symbol 类型和不可枚举的属性），并对这些属性进行数据劫持。
- 劫持后的数据会被挂载到组件实例上，以便在模板中可以直接访问。
- Vue 会递归地对对象和数组进行深度劫持，以确保嵌套的数据结构也能被追踪。
- Vue 不会处理 Symbol 类型的属性名和不可枚举的属性。这些属性不会被挂载到实例上，也不会进行数据劫持。



**劫持限制**：

- Vue 只对普通对象和数组进行劫持，原始类型（如字符串、数字、函数等）不需要劫持。

- 如果对象被冻结（使用 `Object.freeze`），则 Vue 无法对其属性进行劫持，因为冻结的对象不能被修改。
