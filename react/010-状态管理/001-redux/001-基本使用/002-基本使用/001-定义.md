## store目录

在项目中，redux相关的代码  一般会存放到 `src/store`这个目录中



## 行为对象

一个有`type`属性的对象，其中的`type`属性被称之为行为标识

```js
// 行为对象示例
{
  type: 'INCREMENT', // 行为标识
  payload: { // 参数对象
    step: 1
  }
}
```



## reducer

`reducer`是react中的状态管理员，帮助我们统一实现状态的定义和修改

> redux中的状态和修改状态方法应该都被统一定义在一起
>
> 避免了因为定义分散或修改分散导致的可维护性问题

语法结构: `(state, actions) => newState`

1. state --- redux中的公共状态对象
2. actions --- 行为对象 --- 需要进行什么操作
3.  newState -- 返回的新公共状态，用于替代旧的原始公共状态

```js
import { createStore } from 'redux';

// 定义初始状态
const initialState = {
  count: 0
}

const reducer = (state = initialState, action) => {
  switch (action.type) {
    // 需要派发的事件名，命名规则为 全大写单词，多个单词之间使用下划线进行分割
    case 'INCREMENT':
      return {
        ...state,
        count: state.count + 1
      };
    case 'DECREMENT':
      return {
        ...state,
        count: state.count - 1
      };
    // 必须存在返回state的默认代码执行块 --- 用于进行状态初始化
    default:
      return state;
  }
};

// 创建Store --- 创建一个公共容器
const store = createStore(reducer);

export default store;
```



## 初始化

首次执行时，redux内部并不存在对应公共状态，所以redux内部会自动派发一个 随机事件

目的是自动执行一次reducer函数，并初始化对应状态值 --- 此时state的值本质就是`initialState`

```js
function getRandom() {
	return Math.random().toString(36).substring(7).split('').join('.')
}

dispatch({
  // type是随机的，确保执行的是reducer的默认逻辑
  type: `@@redux/INIT${getRandom()}`
})
```

默认派发的事件名是随机的，从而确保reducer执行default逻辑代码块，进而使用传入的参数默认值初始化对应状态



## 事件名抽取

上述示例中的`INCREMENT`，`DECREMENT`等就是派发的事件名，本质其实就是行为对象中的行为标识

`consts.js`

```js
// 为了避免事件名冲突，推荐使用 模块名_事件名的方式 对事件名进行定义 --- 推荐并非强制
export const VOTE_SUPPORT = 'VOTE_SUPPORT'
export const VOTE_DISPOSE = 'VOTE_DISPOSE'

export const COUNT_INCREMENT = 'COUNT_INCREMENT'
export const COUNT_DECREMENT = 'COUNT_DECREMENT'
```















