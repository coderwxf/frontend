## 分类

`dom0级事件绑定`

```js
el.onclick = () => console.log('clicked')
```

1. 通过属性方式进行绑定
2. 同一个元素的同一类型事件只能有一个事件处理函数



`dom2级事件绑定`

```js
el.addEventListener('click', () => console.log('clicked'))
```

1. 通过统一API进行绑定
2. 同一个元素的同一类型事件可以存在多个，会组合为数组，并被依次调用

```js
body.addEventListener('click', (e) => {
  console.log('body')
}, true) // true - 捕获阶段执行

body.addEventListener('click', (e) => {
  console.log('body')
}, false) // false - 表示冒泡阶段执行 -- 默认值
```



## 事件传播

事件执行会分为三个阶段 『 假设触发元素是A 』

1. 捕获阶段
   - 事件从根节点（通常是window）开始，沿着DOM树向下传播
     直到它到达触发事件的那个元素（目标元素A）的父节点
   - 从 window -> document -> html -> body ... -> A的父元素 『 从外到内 』
   - 其目的是建立事件的传播路径
2. 目标阶段
   - 触发 A的捕获事件
   - 触发A的冒泡事件
   - A叫做事件源 「 target 」
3. 冒泡阶段
   - 事件从目标元素开始，沿着DOM树向上冒泡，直到根节点
   - 反向依次执行事件传播链 「 从内到外 」



当事件在元素上触发时

- 如果存在绑定的事件处理函数（Event Handler），则该函数将被执行
- 如果一个元素上没有为特定事件绑定处理函数，则不会有任何响应执行

不是所有的事件都存在事件传播，例如`mouseenter/mouseleave`就不存在事件传播



## eventPhase

对于事件对象来说，有三个阶段,  为了标识事件流的当前阶段

Event 对象提供了一个 eventPhase 属性，它的值是一个整数，表示事件流的当前执行阶段

+ AT_TARGET: 2, 事件目标阶段
+ BUBBLING_PHASE: 3, 冒泡阶段
+ CAPTURING_PHASE: 1  捕获阶段

```js
root.addEventListener('click', e => {
  console.log(e.eventPhase) // 获取事件流的当前阶段
  console.log(Event.prototype.AT_TARGET) // 对应枚举常量值被挂载到了Event的原型对象上
})
```



## 阻止事件传播

我们可以通过`stopPropagation 和 stopImmediatePropagation` 来阻止事件传播

```js
outer.addEventListener('mouseenter', (e) => {
  // `stopPropagation 和 stopImmediatePropagation`阻止事件传播的过程中
  // 无论他们位于当前函数的那个位置，都是先执行完当前函数，在阻止传播
  e.stopPropagation()
  console.log('outer mouseenter 捕获')
})
```



对于DOM2级事件，同名事件函数会被组合成一个数组后被依次执行

- `stopPropagation`而言，是等到数组全部执行完毕后在阻止事件传播
- `stopImmediatePropagation`是 当前事件执行完毕后，立即阻止事件传播

```js
outer.addEventListener('click', (e) => {
  e.stopPropagation()
  console.log('outer click 冒泡1')
})

outer.addEventListener('click', (e) => {
  console.log('outer click 冒泡2')
})

/*
  =>
    outer click 冒泡1
    outer click 冒泡2
*/
```

```js
outer.addEventListener('click', (e) => {
  e.stopImmediatePropagation()
  console.log('outer click 冒泡1')
})

outer.addEventListener('click', (e) => {
  console.log('outer click 冒泡2')
})

/*
  =>
    outer click 冒泡1
*/
```

