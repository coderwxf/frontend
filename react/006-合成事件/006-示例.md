在React 中 合成事件 是通过 `事件委托机制` 来实现的

对于没有事件传播的事件，才是单独绑定到DOM元素自身上



`react17 之前`

- 委托给document
- 只委托了冒泡阶段



`react 17 开始`

- 委托给#root 「 应用容器 」
- 冒泡和捕获阶段都进行了委托



```jsx
import React, { useEffect } from 'react';
import ReactDOM from 'react-dom';

const App = () => {
  useEffect(() => {
    // 原生事件绑定
    // 组件挂载完成后，才添加的原生事件
    // 所以对于同一个元素而言, 合成事件优先于原生事件被添加到对应元素上
    const container = document.getElementById('container');
    const outer = document.getElementById('outer');
    const inner = document.getElementById('inner');

    const handleNativeCapture = (e) => console.log(`${e.currentTarget.id} 捕获 (原生)`);
    const handleNativeBubble = (e) => console.log(`${e.currentTarget.id} 冒泡 (原生)`);

    container.addEventListener('click', handleNativeCapture, true);
    container.addEventListener('click', handleNativeBubble);
    outer.addEventListener('click', handleNativeCapture, true);
    outer.addEventListener('click', handleNativeBubble);
    inner.addEventListener('click', handleNativeCapture, true);
    inner.addEventListener('click', handleNativeBubble);

    return () => {
      container.removeEventListener('click', handleNativeCapture, true);
      container.removeEventListener('click', handleNativeBubble);
      outer.removeEventListener('click', handleNativeCapture, true);
      outer.removeEventListener('click', handleNativeBubble);
      inner.removeEventListener('click', handleNativeCapture, true);
      inner.removeEventListener('click', handleNativeBubble);
    };
  }, []);

  // 合成事件处理函数
  const handleReactCapture = (e) => console.log(`${e.currentTarget.id} 捕获 (合成)`);
  const handleReactBubble = (e) => console.log(`${e.currentTarget.id} 冒泡 (合成)`);

  return (
    <div id="container" onClickCapture={handleReactCapture} onClick={handleReactBubble}>
      <div id="outer" onClickCapture={handleReactCapture} onClick={handleReactBubble}>
        <div id="inner" onClickCapture={handleReactCapture} onClick={handleReactBubble}>
          点击我
        </div>
      </div>
    </div>
  );
};

ReactDOM.render(<App />, document.getElementById('app'));
```



`React17及以后触发结果`

1. 捕获阶段： 

   - `container` 捕获 (合成)
   - `outer` 捕获 (合成)
   - `inner` 捕获 (合成)
   - container` 捕获 (原生)
   - `outer` 捕获 (原生)
   - `inner` 捕获 (原生)

2. 冒泡阶段：

   - `inner` 冒泡 (合成)

   - `outer` 冒泡 (合成)

   - `container` 冒泡 (合成)
   - `inner` 冒泡 (原生)
   - `outer` 冒泡 (原生)
   - `container` 冒泡 (原生)

   

`React17以前触发结果`

1. 捕获阶段：
   - `container` 捕获 (合成)
   - `outer` 捕获 (合成)
   - `inner` 捕获 (合成)
   - `container` 捕获 (原生)
   - `outer` 捕获 (原生)
   - `inner` 捕获 (原生)
2. 冒泡阶段：
   - `inner` 冒泡 (原生)
   - `outer` 冒泡 (原生)
   - `inner` 冒泡 (合成)
   - `outer` 冒泡 (合成)
   - `container` 冒泡 (合成)
   - `container` 冒泡 (原生)
