可以使用 `import.meta.glob` 这个特殊的函数来一次性从文件系统中导入多个模块

1. 这是vite内置功能，只能在vite环境使用

2. 底层通过[fast-glob](https://github.com/mrmlnc/fast-glob)来实现

3. import.meta.glob的配置对象的参数值只能是字面量，不能是变量或表达式

   

```js
// 参数是路径 - 可以是绝对路径，相对路径 或 路径别名
const modules = import.meta.glob('./dir/*.js');
```

会被编译为

```js
// 假设dir目录下，只有foo.js 和 bar.js
const modules = {
  './dir/foo.js': () => import('./dir/foo.js'), 
  './dir/bar.js': () => import('./dir/bar.js'), 
};
```

1. 默认加载方式是懒加载
2. 会在构建时分割成独立的 chunks（代码块）



通过eager选项立即加载模块

```js
const modules = import.meta.glob('./dir/*.js', { eager: true });
```

Vite 生成的代码，这些模块会在一开始就被导入

```js
import * as __glob__0_0 from './dir/foo.js';
import * as __glob__0_1 from './dir/bar.js';
const modules = {
  './dir/foo.js': __glob__0_0,
  './dir/bar.js': __glob__0_1,
};
```



```js
const modules = import.meta.glob('./dir/*.js');

Object.values(modules).forEach(module => {
  // 导入的内容是模块实例，如果要获取默认导出的值需要使用default属性
  routers.push(module.default) 
})
```



```js
// 同时导入多个目录下文件
const modules = import.meta.glob(['./dir/*.js', './another/*.js']);
```



```js
// 排除文件
const modules = import.meta.glob(['./dir/*.js', '!**/bar.js']);
```



通过import选项具名导入

+ import对应的值只能是字符串，并不支持直接导入多个特定的导出

```js
const modules = import.meta.glob('./dir/*.js', { import: 'setup' })
```

```js
// vite 生成的代码
const modules = {
  // 导入内容后，自动解构出 setup对应的值
  './dir/foo.js': () => import('./dir/foo.js').then((m) => m.setup),
  './dir/bar.js': () => import('./dir/bar.js').then((m) => m.setup),
}
```



```js
const modules = import.meta.glob('./dir/*.js', {
  import: 'default', // 直接获取默认导出的内容
  eager: true, // import可以和其他选项一起使用
})
```



```js
// import.meta.glob的默认导入类型是 Record<string, unknown>
// 可以通过泛型替换unknown类型
const routerModule = import.meta.glob<RouteRecordRaw>('./modules/*.ts', {
  import: 'default',
  eager: true
})
```

