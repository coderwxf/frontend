触发组件更新的方式一般有两种

1. props更新 --- 外部触发组件更新
2. state更新 --- 自更新



在DOM-DIFF的时候，每个虚拟节点都去和新树中每一个节点进行比较，会导致复杂度为O(n^3^)

react进行了优化，确保比较复杂度为O(n)

1. 只进行同层比较，不进行跨层比较
2. 如果节点类型不一致，子节点就不再比较，而是产生新的树结构
3. 可以通过key来提升更新性能



## key的作用

没有key时，react进行DOM-DIFF时

1. 比较类型和内容是否相同
2. 会尽可能得就地复用旧节点，但是没有办法识别节点的位置移动更新

有key时，react进行DOM-DIFF时

1. 比较节点内容和key，不在比较内容
2. 可以在实现就地复用的基础上，识别同层组件的位置移动更新，从而实现通过位移来实现组件复用



> 1. 对于尾部插入，key没有过多作用，key的作用主要表现在头部或中间插入或移动节点时的性能优化
> 2. “就地复用”  ---  React 更新过程中尽可能保留和复用 DOM 节点的行为



因此key存在如下要求:

1. key应该是唯一的
2. key应该保持稳定 
   + 不应该使用索引或随机数作为key
   + key应该使用数字或字符串等基本数据类型



不推荐引用类型作为key的原因

1. 相同引用，对应的值结构也可能不同
2. 引用类型在每次渲染时都可能是一个全新的实例，即使它们的内容相同