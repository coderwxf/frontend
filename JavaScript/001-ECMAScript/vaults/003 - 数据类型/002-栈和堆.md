## 执行前的准备

为了执行JavaScript，浏览器会进行如下准备:

1. 开辟一块内存空间，用于执行代码 --- `栈内存空间 (stack)`
2. 开辟一个线程，来自上而下，一行行执行代码 --- `主线程 -- JS执行是单线程的`



## 栈内存

1. 一块内存空间，分为 `代码存储部分` 和 `代码执行部分`

   + 代码存储部分 又可以分为 `变量存储空间` 和 `值存储空间`

   

## 基本类型

基本数据类型都是一些`简单值`，也就是直接将对应值存储在栈内存的值存储空间中

![image-20240311153826427](https://s2.loli.net/2024/03/11/fFh3jLa7I6DiYPc.png) 

![image-20240311154346658](https://s2.loli.net/2024/03/11/4MRFY5XyUT9mKLz.png) 



## 引用类型

基本数据类型 属于 简单值， 直接存储和操作的 直接是值，所以也被称之为值类型

引用类型 属于 复杂值，存储和操作的是 变量存储在 堆内存中 的引用地址



```js
const user = {
  name: 'klaus',
  age: 23
}
```

1. 在变量存储空间新建变量 user
2. 在`堆内存`开启存储空间，地址为 0XFFC3 --->「地址一般都是一个十六进制的值」
3. 将对象的键值对 存入 0XFFC3所对应的地址空间中
4. 将 0XFFC3 存入 值内存空间中
5. 将变量user  和 0XFFC3 关联

> 操作时，通过变量 找到 0XFFC3
>
> 再通过0XFFC3 找到 实际存储的对象



## 连等赋值

```js
let m = n = { m: 1 }

// 等价于 --- 从右往左
let tmp = { m: 1 }
n = tmp // 隐式全局变量 或 赋值给已经存在的变量
let m = tmp
```

```js
let a = { n: 1 }
a.x = a = { n: 2 }

// 等价于 --- 从左往右
let a = { n: 1 }
let tmp = { n: 2 }
a.x = tmp
a = tmp
```

```js
// 示例
let a = { n: 1 }
let b = a
a.x = a = { n: 2 }

console.log(a.x) // => undefined
console.log(b) // => { n: 1, x: { n: 2 } }
```



## 循环引用

```js
let a = { n: 1 }
let b = a
a.x = b
// 所谓循环引用 就是 自己引用自己
// V8 可以正确识别 循环引用 并在合适的时候进行垃圾回收 --- 循环引用不会导致内存泄漏
console.log(a.x === a) // => true
```

